<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.app.product.ProductDAO">
	<select id="detail" parameterType="ProductDTO" resultType="ProductDTO">
		SELECT * FROM product WHERE product_num=#{productNum}
	</select>
	
	<select id="list" parameterType="Pager">
		SELECT * FROM product ORDER BY product_num DESC LIMIT #{startNum}, #{perPage}
	</select>
	
	<select id="count" resultType="Long">
		SELECT COUNT(product_num) FROM product
	</select>
	
	<insert id="add" parameterType="ProductDTO">
		INSERT INTO product VALUES (null, #{productName}, #{productContents}, #{productCategory}, #{productRate}, 0)
	</insert>
	
	<delete id="delete" parameterType="ProductDTO">
		DELETE FROM product WHERE product_num=#{productNum}
	</delete>
	
	<update id="update" parameterType="ProductDTO">
		UPDATE product SET product_name=#{productName}, product_category=#{productCategory}, product_rate=#{productRate}, product_contents=#{productContents} WHERE product_num=#{productNum}
	</update>
	
	
	<!-- 댓글 -->
	<select id="commentList" parameterType="java.util.Map" resultType="ProductCommentDTO">
		SELECT * FROM comment WHERE product_num=#{product.productNum} ORDER BY board_num DESC LIMIT #{pager.startNum}, #{pager.perPage}
	</select>
	
	<insert id="commentAdd" parameterType="ProductCommentDTO">
		INSERT INTO comment VALUES(null, #{boardContents}, now(), #{productNum}, #{username})		
	</insert>
</mapper>